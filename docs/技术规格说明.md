# 技术规格说明书

## 1、前端框架

小程序是现在比较热门的一种移动端应用形式，跨平台且用户使用十分便利。为此我们选择将我们的应用开发在小程序上。小程序的前端框架我们选择了腾讯的wepy前端框架，该框架支持 npm 包，支持 css 预处理器，而且组件美观且有完整的指导文档，便于我们学习以及完成我们的开发任务。

## 2、后端框架

关于后端框架的选择，我们调研了基于python 的Django,Flask 框架，以及基于php 的ThinkPHP,基于java的JSP。最终我们选择了基于python语言的Django框架。愿意如下：

* Django封装较好，学习成本较低，并且功能齐全。我们组开发后端的人员中有的同学完全没有相关的开发经验，选择Django有助于他们快速上手，并完成我们的开发任务。
* 具有较强的数据库访问组件。我们可以方便的对数据库进行操作即使没有SQL语言的基础。
* admin interface. Django 拥有一个完整的后台管理界面。可视化界面简化了我们对后台数据的管理。
* Django 目前的文档已经相当完善，也易于我们学习。
## 3、前端技术

作为手机APP，页面是用户直接接触到的主要部分，也是前端的主要部分。合理的页面布局设计与页面跳转关系是确保用户体验的必要条件。

### 页面转换关系

页面的转换关系如下图，其中，矩形框表示具体页面，连线表示页面的跳转，线上文字表示触发跳转的用户动作。用户按下返回按键时，返回当前页面的上一级页面。当前页面上一级有多个页面时，由哪个页面进入当前页面，则返回哪个页面。

### 插入图片：APP页面转换图

### 页面布局设计

页面布局设计在功能规格说明书中有详细示意图，此处不再重复。设计的主要原则是尽量清晰简明的将该页面中的主要信息传达给用户。

## 4、数据库结构规格

- 数据库中需要存储用户数据、用户个人信息、帖子、申请4个实体，实体之间存在联系，实体也包含属性。联系、属性如下图所示：

## 5、接口规范

### 前端

- 欢迎和登陆页面 `/index/ `
- 注册页面`/register/`
- 发布总览页面` /f/processing/` 
  - 前端拿到未结束请求后一次展示10条（根据前端调整），在底端上拉展示下10条，在顶端下拉刷新。
  - <https://blog.csdn.net/qq_35713752/article/details/79016214> 
  - <https://www.cnblogs.com/simba-lkj/p/6274232.html> 
  - 每条展示：标题，详情前20字，（已用人数/需求人数），截止日期
- 已结束发布总览` /f/ending/ `（可添加）
- 搜索发布` /f/search/[<keyword>,<kind>]/ `(可添加)
- 发布详情` /p/<post_id>/ `
  - 展示发布所有内容
- 帖子收到的申请`/p/<post_id>/apply/`  
- 我的信息 `/my/<ID>/detail/`
- 我的帖子 `/my/<ID>/post/`
- 我的申请`/my/<ID>/apply/`
- 发布帖子`/c/post/`

### 前端需要要加入的功能

+ 微信小程序防止重复提交，（就一个按钮请求未响应时不能再点，防止请求被重复发送）
  + <https://blog.csdn.net/dt1991524/article/details/82585397> 
  + <https://blog.csdn.net/qappleh/article/details/84033766> 

### 后端接口

#### [User](./后端接口规格/User.md)

##### [POST请求](./后端接口规格/User.md#POST请求)

/login/ 用户登录 [已实现]

/login/wechat/ 微信认证登录


/register/ 用户注册 [已实现]

/my/profile/modify/  修改个人信息 [已实现]

/my/change_password/  修改密码 [已实现]

/my/resume/modify/  修改个人简历 [已实现]

##### [GET请求](./后端接口规格/User.md#GET请求)

/GetLoginStatus/  获取登录状态 [已实现]

/my/profile/ 获取当前登录用户的全部个人信息 [已实现]

/my/\<user_id\>/detail/ 获取该user_id的用户的全部个人信息 [已实现]

/my/resume/ 获取当前登录用户的个人简历 [已实现]



#### [Post](./后端接口规格/Post.md)

##### [POST请求](./后端接口规格/Post.md#POST请求)

/c/post/  发布帖子 [已实现]

/p/\<post_id\>/modify/   修改一个帖子的的信息，该帖子的发布者必须是当前登陆的用户 [已实现]

##### [GET请求](./后端接口规格/Post.md#GET请求)

/f/processing/ 获取所有未结束的帖子，按时间先后顺序，时间最近的在第一条 [已实现]

/p/\<post_id\>/ 获取该帖子的详情 [已实现]

/my/\<user_id\>/post/ 获取该ID的用户发布的全部帖子[已实现]



#### [Apply](./后端接口规格/Apply.md)

##### [POST请求](./后端接口规格/Apply.md#POST请求)

/c/apply/ 提交申请，同时将简历的更改同步到个人简历中  [已实现]

/apply/\<apply_id\>/accept/ 同意申请，当前登录用户必须是该申请对应帖子的发布者，当该帖子已同意人数达到所需人数时会自动将其他申请的状态改为closed，并不再接收新的申请 [已实现]

##### [GET请求](./后端接口规格/Apply.md#GET请求)

/p/\<post_id\>/apply/ 获取该帖子收到的所有申请及对应简历信息 [已实现]

/my/\<user_id\>/apply/ 获取该ID的用户的全部申请（不返回简历信息） [已实现]

/apply/\<apply_id\>/ 获取一个申请的状态及简历信息，当前登录用户必须是该申请的发布者或接收者 [已实现]

## 6、错误处理

我们定义错误处理类，对错误进行分类汇总，集中处理，目前暂时分为如下几大类，具体的细化会在开发的时候逐渐扩充。
* InvalidInputError: 处理不合理的输入，比如用户名，密码中的不合理的字符以及发布需求的时候，填入不合法的人数，截至日期等等。
* DataOverflowError: 防止用户输入大量的数据导致程序崩溃，限制用户的输入的长度并且抛出异常。
* FrequentRefreshError: 用户如果过于频发刷新，抛出异常并在一定时间内禁止刷新，防止app崩溃。
## 7、应对变化的灵活性
我们将功能抽象成独立的接口，前端UI操作与后端响应函数与数据管理十分独立，程序每个页面之间的实现也互相独立，程序具有良好的扩展性以及应对变化的能力。
## 8、抗压能力
拥有较好的异常处理机制防止程序崩溃，对于模拟大量用户同时操作的压力测试目前还没有做。






